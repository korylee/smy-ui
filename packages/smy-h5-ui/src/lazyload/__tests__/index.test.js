import Lazy from '..'
import Vue from 'vue'
import { mount } from '@vue/test-utils'
import { delay } from '../../../jest-utils'

test('test lazy plugin', () => {
  Vue.use(Lazy)
  expect(Vue.directive('lazy')).toBeTruthy()
})

const Wrapper = {
  directives: { Lazy },
  data: () => ({
    src: 'https://korylee.github.io/blog/avatar.png',
    error:
      'data:image/png;base64,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',
  }),
  template: `<img v-lazy="src" :lazy-error="error" />`,
}

test('test lazy load', async () => {
  const wrapper = mount(Wrapper)
  await delay(80)
  expect(wrapper.html()).toMatchSnapshot()
})
